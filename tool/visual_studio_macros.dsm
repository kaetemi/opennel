'------------------------------------------------------------------------------'------------------------------------------------------------------------------'FILE DESCRIPTION: New Macro File'------------------------------------------------------------------------------' *** NevraxNewClass ***' NevraxInsertFileHeader' Utility Sub for NevraxNewClass()' (c) 2000, Olivier Cado - Nevrax FranceSub NevraxInsertFileHeader( filename )	ActiveDocument.Selection.StartOfDocument	ActiveDocument.Selection = _		"/* " + filename + vbLf + _		" *" + vbLf + _		" * Copyright (C) 2000 Nevrax. All rights reserved." + vbLf + _		" *" + vbLf + _		" * The redistribution, use and modification in source or binary forms of" + vbLf + _		" * this software is subject to the conditions set forth in the copyright" + vbLf + _		" * document (""Copyright"") included with this distribution." + vbLf + _		" */" + vbLf + vbLf + _		"/*" + vbLf + _		" * $Id: visual_studio_macros.dsm,v 1.4 2000/06/13 13:50:30 cado Exp $" + vbLf + _		" *" + vbLf + _		" * <Replace this by a description of the file>" + vbLf + _		" */" + vbLfEnd SubFunction IsUpCase( str )	IsUpcase = ( str = Ucase(str) )End Function' NevraxClassNameToFileName' Utility Function for NevraxNewClass()' (c) 2000, Olivier Cado - Nevrax FranceFunction NevraxClassNameToFileName( classname )	filename = ""	for i = 1 to len( classname )		charact = mid(classname,i,1 )		if IsUpCase( charact ) then			if i+1 <= len( classname ) then				if not IsUpCase( mid(classname,i+1,1) ) then					filename = filename + "_"				end if			else				filename = filename + "_"			end if		end if		filename = filename + lcase(charact)	next	NevraxClassNameToFileName = filenameEnd Function' NevraxNewClass' DESCRIPTION: Wizard for new class creation' (c) 2000, Olivier Cado - Nevrax FranceSub NevraxNewClass()	' Input class name and file name	ClassName = InputBox( "Nom de la nouvelle classe :", "Nouvelle classe (1)" )	if ClassName = "" then		Exit Sub	end if	Filename = NevraxClassNameToFileName( ClassName )	Filename = InputBox( "Nom de fichier sans l'extension:", "Nouvelle classe (2)", Filename )	if FileName = "" then		Exit Sub	end if	UniqueName = UCase( Filename ) + "_H"	HFilename = Filename + ".h"	CppFilename = Filename + ".cpp"	' Input ancestor class name and file name	NoAncestor = "NO BASE CLASS"	AncClassName = InputBox( "Nom de la classe de base :", "Nouvelle classe (3)", NoAncestor )	if AncClassName = "" then		Exit Sub	else		if AncClassName <> NoAncestor then			AncFilename = InputBox( "Nom de fichier sans l'extension:", "Nouvelle classe (4)" )			if AncFileName = "" then				Exit Sub			end if		end if	end if	AncHFilename = AncFilename + ".h"	' Write .cpp	Documents.Add( "Text" )	NevraxInsertFileHeader( CppFilename )	ActiveDocument.Selection = vbLf + "#include """ + HFilename + """" + vbLf + vbLf + vbLf	ActiveDocument.Selection = "/*" + vbLf + _		" * Constructor" + vbLf + _		" */" + vbLf + _		ClassName + "::" + ClassName + "()" + vbLf + _		"{" + vbLf + _		"}" + vbLf + vbLf + vbLf	ActiveDocument.Save( CppFilename )	ActiveProject.AddFile( CppFilename )	' Write .h	Documents.Add( "Text" )	NevraxInsertFileHeader( HFilename )	ActiveDocument.Selection = vbLf + "#ifndef " + UniqueName + vbLf + _		"#define " + UniqueName + vbLf + vbLf	if AncClassName <> "" then		ActiveDocument.Selection = "#include """ + AncHFilename + """" + vbLf + vbLf	end if	ActiveDocument.Selection = vbLf + _		"/**" + vbLf + _		" * <Replace this by a description of the class>" + vbLf + _		" * \author Olivier Cado" + vbLf + _		" * \author Nevrax France" + vbLf + _		" * \date 2000" + vbLf + _		" */" + vbLf + _		"class " + ClassName	if AncClassName <> "" then		ActiveDocument.Selection = " : public " + AncClassName	end if	ActiveDocument.Selection = vbLf + _		"{" + vbLf + _		"public:" + vbLf + vbLf + _		"	/// Constructor" + vbLf + _		"	" + ClassName + "();" + vbLf + vbLf + _		"};" + vbLf + vbLf	ActiveDocument.Selection = "#endif" + vbLf	ActiveDocument.Selection = vbLf + "/* End of " + HFilename + " */"	ActiveDocument.Save( HFilename )	ActiveProject.AddFile( HFilename )End Sub' *** End of NevraxNewClass ***