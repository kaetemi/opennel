<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"
	i18n:domain="RingRanking"
	metal:use-macro="here/main_template/macros/master">

<metal:block fill-slot="css_slot">
	<style type="text/css" media="screen"
		tal:content="string:@import url(${portal_url}/RingRanking.css);">
	</style>

</metal:block>

<metal:block fill-slot="javascript_head_slot">
	<script src="" type="text/javascript"
		tal:attributes="src string:${portal_url}/js/ajax.js"></script>

	<script type="text/javascript">
		// <![CDATA[
function changeLang(){
	var res="";
	var formulaire = document.getElementById("selectLang");
	if( formulaire.fr.checked == true) res += "'fr',";
	if( formulaire.de.checked == true) res += "'de',";
	if( formulaire.en.checked == true) res += "'en',";
	res = document.URL+"/getRanking?langs=("+res+")";
	// alert(res);
	// getRanking?langs=
	// GET http://en.web-dev.nevrax.com/Members/takyon/ring-rangement/getRanking?langs=('fr','de','en',)
	// GET http://192.168.1.184:8080/ryzom/Members/takyon/cc/ScenarioMasteredRanking/getRanking?langs=('fr',)
	
	sendRequestAndChangeContent("alacon", res);
	
	// var monObjet = eval(res);
}

function sendRequestAndChangeContent(idDom, url){
	var httpTruc = getHTTPObject();
	if (httpTruc){
		unHide(idDom);
		httpTruc.onreadystatechange = function(){
			changeContentOf(idDom, "chargement...");
			if (httpTruc.readyState == 4){ 
				if (httpTruc.status == 200){
					changeContentOf(idDom, httpTruc.responseText);
				} 
				else {
					changeContentOf(idDom, );
				}
			}
		}
		try {
			httpTruc.open("GET", url, true);
		}
		catch(e){
			changeContentOf(idDom, 'erreur de chargement !!!');
			return false;
		}
		
		httpTruc.send(null);
	}
}

function jsonTab2HTML(jsonText){
	var res="";
	
}

		// ]]>
	</script>
</metal:block>

<body>

<div metal:fill-slot="main">

<h1 tal:condition="here/getMasterless"
	i18n:translate="RingRanking_title_am_autonomous">Le classement des
meilleurs sc&eacute;narios autonomes</h1>
<h1 tal:condition="not:here/getMasterless"
	i18n:translate="RingRanking_title_am_dm">Le classement des
meilleurs sc&eacute;narios avec maitre du jeu</h1>

<form action="" id="selectLang"><label for="fr">FR</label> <input
	type="checkbox" id="fr" /> <label for="en">EN</label> <input
	type="checkbox" id="en" /> <label for="de">DE</label> <input
	type="checkbox" id="de" /> <input type="button" value="valider"
	name="valider" onclick="changeLang();" /></form>

<div id="alacon"></div>

<table tal:define="ranks python:here.getRanking()" id="score" border="0"
	cellpadding="0" cellspacing="0">
	<thead>
		<tr>
			<th i18n:translate="RingRanking_rank">Rank</th>
			<th i18n:translate="RingRanking_title">Title</th>
			<th i18n:translate="RingRanking_author">Author</th>
			<th i18n:translate="RingRanking_orientation">Orientation</th>
			<th i18n:translate="RingRanking_level">Level</th>
			<th i18n:translate="RingRanking_score">Score</th>
		</tr>
	</thead>
	<tbody id="scoreBody">
		<div tal:omit-tag="" tal:repeat="rank ranks">
		<tr class="" title="cliquez ici pour plus de details" onclick=""
			tal:define="number repeat/rank/number"
			tal:attributes="class python:'parite'+str(number%2);
							onclick python:'hideOrNot(\'desc'+str(rank['rank'])+'\')';">
			<td tal:content="python:rank['rank']">rank</td>
			<td tal:content="python:rank['title']">titre</td>
			<td tal:content="python:rank['author']">auteur</td>
			<td i18n:translate=""><span
				tal:replace="python:rank['orientation']" /></td>
			<td i18n:translate=""><span tal:replace="python:rank['level']" /></td>
			<td tal:content="python:rank['score']">score</td>
		</tr>
		<tr style="height:0px; padding:0px; margin:0px;">
			<td colspan="6" class="folded">
			<div class="hidden" id=""
					tal:attributes="id python:'desc'+str(rank['rank']);">
				<h4 i18n:translate="RingRanking_description">Description</h4>
				<p tal:content="python:rank['description']"></p>
				<h4 i18n:translate="RingRanking_average_time">Average Time</h4>
				<p tal:content="python:rank['average_time']"></p>
			</div>
			</td>
		</tr>
		</div>
	</tbody>
</table>

</div>

</body>
</html>
